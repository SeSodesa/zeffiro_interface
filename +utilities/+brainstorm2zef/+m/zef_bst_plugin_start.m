
function zef_bst_plugin_start(folder_name)

h_fig = figure(...
    'PaperUnits',get(0,'defaultfigurePaperUnits'),...
    'Units','normalized',...
    'OuterPosition',[0.5 0.5 0.25 0.25],...
    'Renderer',get(0,'defaultfigureRenderer'),...
    'Visible','on',...
    'Color',get(0,'defaultfigureColor'),...
    'CloseRequestFcn','utilities.brainstorm2zef.m.zef_bst_plugin_close;',...
    'CurrentAxesMode','manual',...
    'IntegerHandle','off',...
    'NextPlot',get(0,'defaultfigureNextPlot'),...
    'Colormap',[0 0 0.5625;0 0 0.625;0 0 0.6875;0 0 0.75;0 0 0.8125;0 0 0.875;0 0 0.9375;0 0 1;0 0.0625 1;0 0.125 1;0 0.1875 1;0 0.25 1;0 0.3125 1;0 0.375 1;0 0.4375 1;0 0.5 1;0 0.5625 1;0 0.625 1;0 0.6875 1;0 0.75 1;0 0.8125 1;0 0.875 1;0 0.9375 1;0 1 1;0.0625 1 1;0.125 1 0.9375;0.1875 1 0.875;0.25 1 0.8125;0.3125 1 0.75;0.375 1 0.6875;0.4375 1 0.625;0.5 1 0.5625;0.5625 1 0.5;0.625 1 0.4375;0.6875 1 0.375;0.75 1 0.3125;0.8125 1 0.25;0.875 1 0.1875;0.9375 1 0.125;1 1 0.0625;1 1 0;1 0.9375 0;1 0.875 0;1 0.8125 0;1 0.75 0;1 0.6875 0;1 0.625 0;1 0.5625 0;1 0.5 0;1 0.4375 0;1 0.375 0;1 0.3125 0;1 0.25 0;1 0.1875 0;1 0.125 0;1 0.0625 0;1 0 0;0.9375 0 0;0.875 0 0;0.8125 0 0;0.75 0 0;0.6875 0 0;0.625 0 0;0.5625 0 0],...
    'DoubleBuffer','off',...
    'Name','ZEFFIRO-Brainstorm plugin',...
    'NumberTitle','off',...
    'HandleVisibility','callback',...
    'DeleteFcn','closereq;',...
    'Tag','zeffiro_bst_plugin',...
    'UserData',[],'ToolBar','none','MenuBar','none',...
    'WindowStyle',get(0,'defaultfigureWindowStyle'),...
    'Resize',get(0,'defaultfigureResize'),...
    'PaperPosition',get(0,'defaultfigurePaperPosition'),...
    'PaperSize',[20.99999864 29.69999902],...
    'PaperType',get(0,'defaultfigurePaperType'),...
    'InvertHardcopy',get(0,'defaultfigureInvertHardcopy'),...
    'ScreenPixelsPerInchMode','manual' );

file_name = 'BrainStorm2Zeffiro_import.zef';
subfolder_name = ['+utilities' filesep '+brainstorm2zef' filesep 'data'];

h_button_1 = uicontrol('Style','pushbutton','Parent',h_fig,'Visible','on','Units','normalized','Position',[0.60 0.80 0.35 0.15],'String','Select file','Callback','utilities.brainstorm2zef.m.zef_bst_setup_file;');
h_button_2 = uicontrol('Style','pushbutton','Parent',h_fig,'Visible','on','Units','normalized','Position',[0.60 0.35 0.35 0.15],'String','Reset project','Callback','utilities.brainstorm2zef.m.zef_bst_reset_project;');
h_button_3 = uicontrol('Style','pushbutton','Parent',h_fig,'Visible','on','Units','normalized','Position',[0.60 0.20 0.35 0.15],'String','Edit project','Callback','utilities.brainstorm2zef.m.zef_bst_edit_project;');
h_button_5 = uicontrol('Style','pushbutton','Parent',h_fig,'Visible','on','Units','normalized','Position',[0.60 0.05 0.35 0.15],'String','Run script','Callback','utilities.brainstorm2zef.m.zef_bst_run;');

run_script_list = dir([folder_name filesep '+utilities' filesep '+brainstorm2zef' filesep '+m' filesep '+run_script_bank']);
run_script_list = {run_script_list().name}'; 
run_script_list = run_script_list(3:end);

postprocessing_script_list = dir([folder_name filesep '+utilities' filesep '+brainstorm2zef' filesep '+m' filesep '+postprocessing_script_bank']);
postprocessing_script_list = {postprocessing_script_list().name}'; 
postprocessing_script_list = postprocessing_script_list(3:end);

for i = 1 : length(run_script_list)
[~,name_string] = fileparts(run_script_list{i});
run_script_list{i} = name_string;
end

for i = 1 : length(postprocessing_script_list)
[~,name_string] = fileparts(postprocessing_script_list{i});
postprocessing_script_list{i} = name_string;
end

h_popmenu_1 = uicontrol('Style','popupmenu','Parent',h_fig,'Visible','on','Units','normalized','Position',[0.05 0.05 0.35 0.1],'String',postprocessing_script_list,'Tag','postprocessing_script');
h_popmenu_2 = uicontrol('Style','popupmenu','Parent',h_fig,'Visible','on','Units','normalized','Position',[0.05 0.35 0.35 0.1],'String',run_script_list,'Tag','run_script');

h_text_1 = uicontrol('Style','text','Parent',h_fig,'Units','normalized','String',[folder_name filesep subfolder_name filesep file_name],'HorizontalAlignment','left','Position',[0.05 0.55 0.9 0.2],'BackgroundColor',[0.9 0.9 0.9],'Tag','setup_file');
h_text_2 = uicontrol('Style','text','Parent',h_fig,'Units','normalized','String','Postprocessing script:','HorizontalAlignment','left','Position',[0.05 0.15 0.35 0.1],'BackgroundColor',[0.94 0.94 0.94]);
h_text_3 = uicontrol('Style','text','Parent',h_fig,'Units','normalized','String','Run script:','HorizontalAlignment','left','Position',[0.05 0.45 0.35 0.1],'BackgroundColor',[0.94 0.94 0.94]);

h_axes = uiaxes('Parent',h_fig,'visible','on','Units','normalized','Position',[0.05 0.775 0.375 0.20],'FontSize',0.587962962962963,'Tag','image_axes','BackgroundColor',[0.94 0.94 0.94],'Visible','off');
imagesc(h_axes,imread([folder_name filesep 'fig' filesep 'zeffiro_logo.png'], 'BackgroundColor', [0.94 0.94 0.94]));

addprop(h_fig,'folder_name');
set(h_fig,'folder_name',folder_name);