\section{Lead field construction}\label{sec:lead-field-construction}

\subsection{Fields of \code{zef} needed by the lead field construction routines}%
\label{ssec:meshing-fields}

This section lists the fields of central struct \code{zef} of Zeffiro
Interface, that a user needs to set with the syntax
\begin{lstlisting}[style=unnumberedlines, language=Matlab]
zef.field_name = field_value;
\end{lstlisting}
in order to successfully generate a lead field via Zeffiro Interface's lead
field routines. The names, sizes, types, validators and descriptions are
specified, in the spirit of Matlab's class property and function argument
validation, even if no validation is actually performed for these fields.

\zeffield{nodes}{:,3}{double}{}{The nodes of the currently existing finite
element mesh. This will be constructed alongside with \code{tetra} when the
mesh generation routine is run.}



\zeffield{tetra}{:,4}{uint32}{ mustBePositive }{The tetrahedra in the
current finite element mesh. This will be constructed alongside with
\code{nodes} when the mesh generation routine is run. }


\zeffield{acceptable\_source\_depth}{1,1}{double}{mustBeNonnegative}{Determines
how much of the active layers are peeled off before sources are placed
into them. The depth of \SI{0}{\milli\meter} means that only the
surfacemost layer is peeled off, as the peeling algorithm requires that
all nodes in a tetrahedron are further than the given value for the tetra
to be considered as a valid source position.}

\zeffield{optimization\_system\_type}{1,:}{char}{mustBeMember(['pbo',
'mpo'])}{Determines what optimization method is used in source space
interpolation. Options are \code{'pbo'} for position-based optimization, or
\code{'mpo'} for mean position and orientation.}

\zeffield{source\_model}{1,1}{ZefSourceModel}{}{Determines which source model
is to be used when positioning the sources. Options include
\code{ZefSourceModel.\{Hdiv, Whitney, StVenant\}}.}

\zeffield{source\_direction\_mode}{1,1}{int32}{}{Determines how the columns of
a lead field \(L\) are interpreted. the options are (1) cartesian, (2) normal
(3) face-based.}

\zeffield{preconditioner}{1,:}{char}{mustBeMember([TODO])}{TODO.}

\zeffield{preconditioner\_tolerance}{1,1}{double}{mustBePositive}{TODO.}

\zeffield{solver\_tolerance}{1,1}{double}{mustBePositive}{TODO.}

\zeffield{n\_sources}{1,1}{uint32}{mustBePositive}{The number of sources whose
even placement is attempted into the the currently existing mesh. If the
mesh is not fine enough, the number of actually placed sources might not
be as high as requested.}

\zeffield{sigma}{size(tetra,1),1}{double}{}{The conductivities of the tetrahedra.}

\zeffield{sensors}{:,6}{double}{}{A set of sensors. If point electrode model (PEM) is
used, this will be a \code{(:,3)} array of electrode positions, whereas if
complete eletrode model is used, this should be a \code{(:,6)} array of 3D
positions, inner and outer radii and finally impedances.}
